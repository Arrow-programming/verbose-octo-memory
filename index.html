<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Church Psalter Slideshow</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pptxgenjs/3.6.0/pptxgen.min.js"></script>
</head>
<body>
    <h1>Church Psalter Slideshow</h1>

    <form id="psalterForm">
        <label for="psalterTitle">Psalter Title:</label>
        <input type="text" id="psalterTitle" name="psalterTitle" required><br><br>

        <label for="verses">Verses (comma-separated):</label>
        <input type="text" id="verses" name="verses" required><br><br>

        <button type="submit">Generate PowerPoint</button>
    </form>

    <script>
        async function fetchPsalters() {
            const response = await fetch('https://raw.githubusercontent.com/Arrow-programming/verbose-octo-memory/main/psalterMain.js');
            const text = await response.text();
            const jsonData = text.match(/const psalterData = (\[.*\]);/s)[1];
            return JSON.parse(jsonData);
        }

        document.getElementById('psalterForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            const psalterTitle = document.getElementById('psalterTitle').value;
            const versesInput = document.getElementById('verses').value.split(',').map(v => v.trim());

            const psalterData = await fetchPsalters();
            const selectedPsalter = psalterData.find(p => p.psalterTitle === psalterTitle);
            if (!selectedPsalter) {
                alert('Psalter not found');
                return;
            }

            const pptx = new PptxGenJS();
            pptx.setTitle('Church Psalter Slideshow');

            versesInput.forEach(verseIndex => {
                const verse = selectedPsalter.verses[verseIndex - 1];
                if (verse) {
                    const slide = pptx.addSlide();
                    slide.addText(verse.lyrics, { x: 1, y: 1, fontSize: 24 });
                }
            });

            pptx.writeFile({ fileName: 'Church_Psalter_Slideshow.pptx' });
        });
    </script>
</body>
</html>
